@inherits LayoutComponentBase
@implements IDisposable
@inject SyncService Syncer
@inject ILogger<AgriPosPoC.Client.Shared.MainLayout> Logger
<div class="page">
    <div class="sidebar">
        <NavMenu />
    </div>

    <main>
        

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code {
    private System.Threading.Timer? _timer;

    protected override void OnInitialized()
    {
        // Start a timer that ticks every 30 seconds
        _timer = new Timer(_ =>
             {
                 // This runs the async method without awaiting it
                 _ = Syncer.TrySyncInvoicesAsync();
             },
             null,
             TimeSpan.FromSeconds(10),  // Wait 10s before first run
             TimeSpan.FromSeconds(30)); // Run every 30s
    }

    public void Dispose()
    {
        _timer?.Dispose();
    }
}